<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Chatbot SmartID</title>
</head>
<body>
  <h2>ðŸ¤– Chatbot SmartID (Crisp)</h2>
  <div id="log"></div>

  <!-- <script>
    function getCookie(name) {
      const allCookies = document.cookie; 
      const cookiesArray = allCookies.split("; ").map(cookieStr => {
        const [name, ...rest] = cookieStr.split("=");
        const value = rest.join("=");
        return { name, value };
      });

      const sessionCookies = cookiesArray.filter(c => c.value.includes(name));
      console.log(sessionCookies)
      return sessionCookies[0]?.value;
    }

    async function processCrisp() {
      const session = getCookie("session");
      if (!session) {
        console.log(`Ga ada session ${session}`);
        return;
      }

      const res = await fetch(`https://chatbot-smartid.vercel.app/process-crisp?sessionId=${session}`);
      const data = await res.json();
      console.log('data', data);
      console.log('status', data.status);

      if (data.status === "success") {
        logMessage(data.sent, "bot");
      }
    }

    function logMessage(msg, sender) {
      const log = document.getElementById("log");
      const div = document.createElement("div");
      div.textContent = `[${sender}] ${msg}`;
      log.appendChild(div);
    }

    // Request pertama langsung dijalankan
    processCrisp();

    // Interval berikutnya baru mulai setelah 40 detik
    setTimeout(() => {
      setInterval(processCrisp, 40000);
    }, 40000);
  </script> -->

  <script type="text/javascript">
    window.$crisp = [];
    window.CRISP_WEBSITE_ID = "2bd940f6-2190-436e-bbb0-1d419f2dd437";
    (function(){
      var d = document;
      var s = d.createElement("script");
      s.src = "https://client.crisp.chat/l.js";
      s.async = 1;
      d.getElementsByTagName("head")[0].appendChild(s);
    })();
  </script>
</body>
</html>
